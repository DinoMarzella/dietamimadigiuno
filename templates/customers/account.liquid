{% for xtag in customer.tags %}
{% assign tag = xtag | downcase %}
{% if tag == 'approved' %}
{%assign approved= true %}
{% endif %}
{% if tag == 'lhp' or tag == 'affiliate' or tag == 'provider' or tag == 'hcp' or tag == 'hcr' or tag == 'hcc' or tag == 'hcr-recommender' %}

{% assign isProvider = true %}

{% endif %}
{% endfor %}
<!-- customer.email {{customer.email}}  -->
{% if isProvider %}
{% layout none %}  
{% include 'pro-dashboard-main' %}
 
{% else %} 
 
<style>   
  .account-page-actions{
        display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  .mt-5{
    margin-top: 15px;
  }
  .provider-links {
    display: flex;
    flex-direction: column;
    max-width: 245px;
}

.provider-links a {
    margin-top:10px;
    display: block;
}
  
   .announcement-bar {
    display: none;}
 
</style>  
 



{% paginate customer.orders by 20 %}

<div class="page-width page-content">
  <header class="section-header{% unless settings.type_headers_align_text %} section-header--with-link{% endunless %}">
    <h1 class="section-header__title">{{ 'customer.account.title' | t }}</h1>
    <div class="account-page-actions">
      
    {% if isProvider%}
    <div class="mt-5">
      <a href="https://prolonfmd.com/products/prolon-provider" class="text-link btn">Shop ProLon</a>
      <a href="https://prolonfmd.com/products/fastbar-provider" class="ml-5 text-link btn">Shop Fast Bar</a>
      <a href="https://prolonfmd.com/products/reset-for-providers" class="ml-5 text-link btn">Shop ReSet</a> 
        
    </div>
    <p>*Special Provider Pricing</p>
    {% endif %}
    <a href="{{ routes.account_logout_url }}" class="btn btn--secondary btn--small section-header__link">{{ 'layout.customer.log_out'| t }}</a>
    </div>
  </header>

  <div class="grid">

    <div class="grid__item medium-up--two-thirds">
    {% if isProvider %}
    <h2> Office Order History</h2>
    {% else %} 
      <h2>{{ 'customer.orders.title' | t }}</h2>
    {% endif %}
      {% if customer.orders.size != 0 %}

        <table class="table--responsive table--small-text">
          <thead>
            <tr>
              <th>{{ 'customer.orders.order_number' | t }}</th>
              <th>{{ 'customer.orders.date' | t }}</th>
              <th>{{ 'customer.orders.payment_status' | t }}</th>
              <th>{{ 'customer.orders.fulfillment_status' | t }}</th>
              <th>{{ 'customer.orders.total' | t }}</th>
            </tr>
          </thead>
          <tbody>
            {% for order in customer.orders %}
              <tr class="table__section">
                <td data-label="{{ 'customer.orders.order_number' | t }}">{{ order.name | link_to: order.customer_url }}</td>
                <td data-label="{{ 'customer.orders.date' | t }}">{{ order.created_at | time_tag: format: 'date' }}</td>
                <td data-label="{{ 'customer.orders.payment_status' | t }}">{{ order.financial_status_label }}</td>
                <td data-label="{{ 'customer.orders.fulfillment_status' | t }}">{{ order.fulfillment_status_label }}</td>
                <td data-label="{{ 'customer.orders.total' | t }}">{{ order.total_price | money }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

        <hr class="hr--clear">

      {% else %}

        <p>{{ 'customer.orders.none' | t }}</p>

      {% endif %}
    </div>

    <div class="grid__item medium-up--one-third right-side-account-links">
      {% include 'provider-account-links'  %}
      <h3>{{ 'customer.account.details' | t }}</h3>
 
      <p class="h5">{{ customer.name }}</p>
<!-- Begin ReCharge code -->
<p id="rc_link_container">
    <a href="/tools/recurring/login">Manage Subscriptions</a>
</p>
<!-- End ReCharge code -->

      
      <p id="hcp-code-placeholder" class=""></p>
{% unless isProvider %}
<p><a href="/tools/recurring/login" class="text-link">Manage Subscription</a></p> 
 
  
      {{ customer.default_address | format_address }}
      {% endunless %}
      <p><a href="{{ routes.account_addresses_url }}" class="text-link">{{ 'customer.account.view_addresses' | t }} ({{ customer.addresses_count }})</a></p>
    </div>

  </div> 

  {% if paginate.pages > 1 %}
    {% render 'pagination', paginate: paginate %}
  {% endif %}
</div>
{% endpaginate %}
{% if isProvider %}
<script>
  
//   window.API_URL = "http://localhost:1337/";
  window.API_URL = "https://prolon-pro.herokuapp.com/";
  
  jQuery( document ).ready(function() {
    let email = "{{customer.email}}";
    loadHCP(email)    
  });
  
  function loadHCP(email){
    jQuery.ajax({ 
      type: "GET",
      url: `${window.API_URL}customer/hcp?email=${email}&shop=${Shopify.shop}`,
      cache: !1,
      dataType: "json",
      success: function(data) {
        jQuery('#hcp-code-placeholder').html(`<strong>My HCP Code: ${data.hcp}</strong>`)
      }
    })
  }
</script>
{% endif %}
 
{% endif %}